{"ast":null,"code":"import _regeneratorRuntime from \"/home/its/project/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"/home/its/project/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport axios from \"axios\";\nimport Cookie from \"js-cookie\";\nimport router from \"@/routes\";\nimport apiEvents from \"./methods/event\";\nimport apiAuth from \"./methods/auth\";\nimport ValidationErrors from \"@/services/exeptions/ValidationErrors\";\nvar client = axios.create({\n  baseURL: \"http://cargasm.test/api/v1/\" // withCredentials: true\n\n});\nexport default {\n  cleanRestApi: function cleanRestApi(obj) {\n    for (var propName in obj) {\n      if (!obj.hasOwnProperty(propName)) continue;\n    }\n  },\n  setupRestApi: function setupRestApi(store, router) {\n    var _this = this;\n\n    client.interceptors.request.use( /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(config) {\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                config.headers.common[\"Accept\"] = \"multipart/form-data\";\n                config.headers.common[\"Cache-Control\"] = \"no-cache\";\n                config.headers.common[\"Cache-Control\"] = \"no-cache\";\n                config.headers.common[\"Pragma\"] = \"no-cache\";\n                config.headers.common[\"Expires\"] = \"0\";\n\n                if (config.method === \"put\" || config.method === \"post\") {\n                  _this.cleanRestApi(config.data);\n                }\n\n                if (Cookie.get(\"access_token\")) {\n                  config.headers.common[\"Authorization\"] = \"Bearer \".concat(Cookie.get(\"access_token\"));\n                }\n\n                return _context.abrupt(\"return\", config);\n\n              case 8:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }(), /*#__PURE__*/function () {\n      var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2(error) {\n        return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                return _context2.abrupt(\"return\", Promise.reject(error));\n\n              case 1:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2);\n      }));\n\n      return function (_x2) {\n        return _ref2.apply(this, arguments);\n      };\n    }());\n    client.interceptors.response.use( /*#__PURE__*/function () {\n      var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3(response) {\n        return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                return _context3.abrupt(\"return\", response);\n\n              case 1:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3);\n      }));\n\n      return function (_x3) {\n        return _ref3.apply(this, arguments);\n      };\n    }(), /*#__PURE__*/function () {\n      var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee4(error) {\n        var code;\n        return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                code = error.response && error.response.status ? error.response.status : 500;\n\n                if (!(code === 422)) {\n                  _context4.next = 3;\n                  break;\n                }\n\n                return _context4.abrupt(\"return\", Promise.reject(new ValidationErrors(error.response)));\n\n              case 3:\n                if (!(code === 401)) {\n                  _context4.next = 5;\n                  break;\n                }\n\n                return _context4.abrupt(\"return\", Promise.reject({\n                  message: \"Authorized fail\"\n                }));\n\n              case 5:\n                if (code === 404) {}\n\n                if (code === 500) {// router.push('/500');\n                }\n\n                return _context4.abrupt(\"return\", Promise.reject(error));\n\n              case 8:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4);\n      }));\n\n      return function (_x4) {\n        return _ref4.apply(this, arguments);\n      };\n    }());\n  },\n  install: function install(Vue, store, router) {\n    this.app = Vue.prototype;\n    this.setupRestApi(store, router);\n    var repositories = {\n      event: apiEvents(client),\n      auth: apiAuth(client)\n    };\n    Vue.prototype.$api = repositories;\n    store.$api = repositories;\n  }\n};","map":{"version":3,"names":["axios","Cookie","router","apiEvents","apiAuth","ValidationErrors","client","create","baseURL","cleanRestApi","obj","propName","hasOwnProperty","setupRestApi","store","interceptors","request","use","config","headers","common","method","data","get","error","Promise","reject","response","code","status","message","install","Vue","app","prototype","repositories","event","auth","$api"],"sources":["/home/its/project/src/modules/api/api.js"],"sourcesContent":["import axios from \"axios\";\nimport Cookie from \"js-cookie\";\nimport router from \"@/routes\";\n\nimport apiEvents from \"./methods/event\";\nimport apiAuth from \"./methods/auth\";\n\nimport ValidationErrors from \"@/services/exeptions/ValidationErrors\";\n\nlet client = axios.create({\n  baseURL: \"http://cargasm.test/api/v1/\",\n  // withCredentials: true\n});\n\nexport default {\n  cleanRestApi(obj) {\n    for (const propName in obj) {\n      if (!obj.hasOwnProperty(propName)) continue;\n    }\n  },\n  setupRestApi(store, router) {\n    client.interceptors.request.use(\n      async (config) => {\n        config.headers.common[\"Accept\"] = \"multipart/form-data\";\n        config.headers.common[\"Cache-Control\"] = \"no-cache\";\n        config.headers.common[\"Cache-Control\"] = \"no-cache\";\n        config.headers.common[\"Pragma\"] = \"no-cache\";\n        config.headers.common[\"Expires\"] = \"0\";\n        if (config.method === \"put\" || config.method === \"post\") {\n          this.cleanRestApi(config.data);\n        }\n\n        if (Cookie.get(\"access_token\")) {\n          config.headers.common[\"Authorization\"] = `Bearer ${Cookie.get(\n            \"access_token\"\n          )}`;\n        }\n        return config;\n      },\n\n      async (error) => {\n        return Promise.reject(error);\n      }\n    );\n\n    client.interceptors.response.use(\n      async (response) => {\n        return response;\n      },\n      async (error) => {\n        let code =\n          error.response && error.response.status ? error.response.status : 500;\n\n        if (code === 422) {\n          return Promise.reject(new ValidationErrors(error.response));\n        }\n\n        if (code === 401) {\n          return Promise.reject({\n            message: \"Authorized fail\",\n          });\n        }\n\n        if (code === 404) {\n        }\n\n        if (code === 500) {\n          // router.push('/500');\n        }\n\n        return Promise.reject(error);\n      }\n    );\n  },\n  install(Vue, store, router) {\n    this.app = Vue.prototype;\n    this.setupRestApi(store, router);\n    const repositories = {\n      event: apiEvents(client),\n      auth: apiAuth(client),\n    };\n\n    Vue.prototype.$api = repositories;\n    store.$api = repositories;\n  },\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}