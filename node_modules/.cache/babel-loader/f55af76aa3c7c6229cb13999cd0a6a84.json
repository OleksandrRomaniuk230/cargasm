{"ast":null,"code":"import _defineProperty from \"/home/its/project/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";\nimport _regeneratorRuntime from \"/home/its/project/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"/home/its/project/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\n\nvar _mutations;\n\nimport Cookie from 'js-cookie';\nvar SET_TOKEN = 'SET_TOKEN';\nvar LOGAUT = 'LOGAUT';\nvar PROFILE = 'PROFILE';\nexport default {\n  namespaced: true,\n  state: {\n    token: Cookie.get('token') || null,\n    refreshToken: Cookie.get('refreshToken') || null,\n    permissions: Cookie.get('permissions') || null,\n    profile: null,\n    userId: Cookie.get('userId') || null\n  },\n  getters: {\n    token: function token(state) {\n      return state.token;\n    },\n    refreshToken: function refreshToken(state) {\n      return state.refreshToken;\n    },\n    permissions: function permissions(state) {\n      return state.permissions;\n    },\n    profile: function profile(state) {\n      return state.profile;\n    },\n    profileHeader: function profileHeader(state) {\n      if (state.profile) return {\n        Person: state.profile.Person || null,\n        PersonImage: state.profile.PersonImage || null\n      };\n    },\n    userId: function userId(state) {\n      return state.userId;\n    },\n    loggedIn: function loggedIn(state) {\n      return !!state.token;\n    }\n  },\n  actions: {\n    login: function login(_ref, payload) {\n      var _this = this;\n\n      return _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n        var dispatch, commit, _yield$_this$$api$aut, data;\n\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                dispatch = _ref.dispatch, commit = _ref.commit;\n                _context.next = 3;\n                return _this.$api.auth.login(payload);\n\n              case 3:\n                _yield$_this$$api$aut = _context.sent;\n                data = _yield$_this$$api$aut.data;\n                _context.next = 7;\n                return commit('SET_TOKEN', data.data);\n\n              case 7:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }))();\n    }\n  },\n  mutations: (_mutations = {}, _defineProperty(_mutations, SET_TOKEN, function (state, payload) {\n    if (payload.accessToken !== undefined) {\n      Cookie.set('token', payload.accessToken);\n      Cookie.set('refreshToken', payload.refreshToken);\n      Cookie.set('permissions', payload.user.permissions);\n      Cookie.set('userId', payload.user.id);\n      state.token = payload.accessToken;\n      state.refreshToken = payload.refreshToken;\n      state.permissions = payload.user.permissions;\n      state.userId = payload.user.id;\n    }\n  }), _defineProperty(_mutations, PROFILE, function (state, payload) {\n    state.profile = payload;\n  }), _defineProperty(_mutations, LOGAUT, function (state) {\n    console.log('mutation');\n    Cookie.remove('token');\n    Cookie.remove('refreshToken');\n    Cookie.remove('permissions');\n    Cookie.remove('userId');\n    state.token = null;\n    state.refreshToken = null;\n    state.permissions = null;\n    state.userId = null;\n  }), _mutations)\n};","map":{"version":3,"names":["Cookie","SET_TOKEN","LOGAUT","PROFILE","namespaced","state","token","get","refreshToken","permissions","profile","userId","getters","profileHeader","Person","PersonImage","loggedIn","actions","login","payload","dispatch","commit","$api","auth","data","mutations","accessToken","undefined","set","user","id","console","log","remove"],"sources":["/home/its/project/src/store/auth.js"],"sourcesContent":["import Cookie from 'js-cookie';\n\nconst SET_TOKEN = 'SET_TOKEN'\nconst LOGAUT = 'LOGAUT'\nconst PROFILE = 'PROFILE'\n\nexport default {\n  namespaced: true,\n  state: {\n      token: Cookie.get('token') || null,\n      refreshToken: Cookie.get('refreshToken') || null,\n      permissions: Cookie.get('permissions') || null,\n      profile: null,\n      userId: Cookie.get('userId') || null\n  },\n\n  getters: {\n    token: state => state.token,\n    refreshToken: state => state.refreshToken,\n    permissions: state => state.permissions,\n    profile: state => state.profile,\n    profileHeader: state => {\n      if (state.profile)\n      return {\n        Person: state.profile.Person || null,\n        PersonImage: state.profile.PersonImage || null\n      }\n    },\n    userId: state => state.userId,\n    loggedIn: state => !!state.token\n  },\n\n  actions: {\n    async login({dispatch, commit}, payload) {\n      let { data } = await this.$api.auth.login(payload)\n      await commit('SET_TOKEN', data.data)\n    \n      // return data\n    },\n  },\n  mutations: {\n    [SET_TOKEN](state, payload) {\n      if (payload.accessToken !== undefined) {\n        Cookie.set('token', payload.accessToken)\n        Cookie.set('refreshToken', payload.refreshToken)\n        Cookie.set('permissions', payload.user.permissions)\n        Cookie.set('userId', payload.user.id)\n        state.token = payload.accessToken\n        state.refreshToken = payload.refreshToken\n        state.permissions = payload.user.permissions\n        state.userId = payload.user.id\n      }\n    },\n    [PROFILE](state, payload) {\n        state.profile = payload\n    },\n    [LOGAUT](state) {\n      console.log('mutation')\n      Cookie.remove('token')\n      Cookie.remove('refreshToken')\n      Cookie.remove('permissions')\n      Cookie.remove('userId')\n      state.token = null\n      state.refreshToken = null\n      state.permissions = null\n      state.userId = null\n    }\n  },\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}